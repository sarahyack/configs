/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var c=Object.defineProperty;var w=Object.getOwnPropertyDescriptor;var L=Object.getOwnPropertyNames;var M=Object.prototype.hasOwnProperty;var K=(s,o)=>{for(var e in o)c(s,e,{get:o[e],enumerable:!0})},k=(s,o,e,t)=>{if(o&&typeof o=="object"||typeof o=="function")for(let i of L(o))!M.call(s,i)&&i!==e&&c(s,i,{get:()=>o[i],enumerable:!(t=w(o,i))||t.enumerable});return s};var b=s=>k(c({},"__esModule",{value:!0}),s);var E={};K(E,{default:()=>d});module.exports=b(E);var g=require("obsidian");var a=require("obsidian"),y={stackTabsInPopout:!0,modifierKey:"metaKey",transitionStyle:"slide"},r=class extends a.PluginSettingTab{constructor(o,e){super(o,e),this.plugin=e}display(){let{containerEl:o}=this;o.empty(),o.createEl("h1",{text:"Quick Select Settings"});let e=o.createSpan();e.setText(" (press key)"),document.addEventListener("keydown",t=>{(t.metaKey||t.ctrlKey||t.altKey)&&e.setText(t.key)}),new a.Setting(o).setName("Modifier key").setDesc(createFragment(t=>{t.appendText("Choose the key that activates Quick Select: "),t.append(e)})).addDropdown(t=>t.addOptions({metaKey:"Meta",ctrlKey:"Control",altKey:"Alt"}).setValue(this.plugin.settings.modifierKey).onChange(async i=>{this.plugin.settings.modifierKey=i,await this.plugin.saveSettings()})),new a.Setting(o).setName("Counter transition style").setDesc("Set transition style of Quick Select counters").addDropdown(t=>t.addOptions({none:"None",fade:"Fade",slide:"Slide",permanent:"Permanent"}).setValue(this.plugin.settings.transitionStyle).onChange(async i=>{console.log(document.body.classList),document.body.classList.forEach(n=>{/^quick-select-transition-/.test(n)&&document.body.classList.remove(n)}),document.body.classList.add(`quick-select-transition-${i}`),this.plugin.settings.transitionStyle=i,await this.plugin.saveSettings()})),o.createEl("h2",{text:"Miscellaneous"}),new a.Setting(o).setName("Stack tabs in popout windows").setDesc("Enable or disable stacked tabs for popout windows").addToggle(t=>t.setValue(this.plugin.settings.stackTabsInPopout).onChange(async i=>{this.plugin.settings.stackTabsInPopout=i,await this.plugin.saveSettings()}))}};var h=s=>{s.body.classList.add("quick-select-mod-key-active")},m=(s,o)=>{s.body.classList.add(`quick-select-transition-${o}`)},p=s=>{s.body.classList.remove("quick-select-mod-key-active")},f=(s,o)=>{s.body.classList.remove(`quick-select-transition-${o}`)},v=s=>"app"in s&&"workspace"in s.app;function S(s){return s.length===1&&s>="1"&&s<="9"}var d=class extends g.Plugin{constructor(){super(...arguments);this.activeModal=null;this.popoutWindows=new Set;this.isModifierKeyPressed=!1}async onload(){await this.loadSettings(),this.addSettingTab(new r(this.app,this)),this.modalObserver=new MutationObserver(this.handleDOMMutation.bind(this)),this.modalObserver.observe(document.body,{childList:!0,subtree:!0}),this.registerEvent(this.app.workspace.on("layout-change",this.handleLayoutChange.bind(this))),m(document,this.settings.transitionStyle),this.modifierKeyListener=this.handleModifierKeyChange.bind(this),document.addEventListener("keydown",this.modifierKeyListener),document.addEventListener("keyup",this.modifierKeyListener),this.checkForActiveModal()}async loadSettings(){this.settings=Object.assign({},y,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}handleModifierKeyChange(e){let t=e[this.settings.modifierKey];this.isModifierKeyPressed!==t&&(this.isModifierKeyPressed=t,this.activeModal&&this.updateModalModifierClass())}updateModalModifierClass(){this.activeModal&&(this.isModifierKeyPressed?setTimeout(()=>{this.activeModal&&this.isModifierKeyPressed&&h(this.activeModal.ownerDocument)},150):p(this.activeModal.ownerDocument))}handleLayoutChange(){this.app.workspace.iterateAllLeaves(e=>{let t=e.view.containerEl.closest("body");if(t!=null&&t.classList.contains("is-popout-window")){let i=t.ownerDocument.defaultView;i&&v(i)&&!this.popoutWindows.has(i)&&this.initializePopoutWindow(i)}})}initializePopoutWindow(e){this.popoutWindows.add(e);let t=new MutationObserver(this.handleDOMMutation.bind(this));t.observe(e.document.body,{childList:!0,subtree:!0}),e.addEventListener("keydown",this.modifierKeyListener),e.addEventListener("keyup",this.modifierKeyListener),this.settings.stackTabsInPopout&&this.setStackedTabsForPopoutWindow(e.app.workspace),this.register(()=>{t.disconnect(),e.removeEventListener("keydown",this.modifierKeyListener),e.removeEventListener("keyup",this.modifierKeyListener),this.popoutWindows.delete(e)})}setStackedTabsForPopoutWindow(e){let t=e;t.onLayoutReady(()=>{t.floatingSplit&&t.floatingSplit.children.forEach(i=>{i.children.forEach(n=>{n.children[0].view.getViewType()!=="outline"&&n.setStacked(!0)})})})}handleDOMMutation(e){for(let t of e)t.addedNodes.forEach(i=>{i instanceof HTMLElement&&(i.classList.contains("modal-container")||i.classList.contains("suggestion-container"))&&this.handleModalOpen(i)}),t.removedNodes.forEach(i=>{i instanceof HTMLElement&&(i.classList.contains("modal-container")||i.classList.contains("suggestion-container"))&&this.handleModalClosed(i)})}handleModalOpen(e){this.activeModal=e,this.modalKeyListener=t=>this.interceptModalKeys(t),this.modalKeyWindow=e.ownerDocument.defaultView,this.modalKeyWindow.addEventListener("keydown",this.modalKeyListener,!0),this.isModifierKeyPressed&&this.updateModalModifierClass()}handleModalClosed(e){this.activeModal===e&&(p(e.ownerDocument),this.activeModal=null,this.modalKeyListener&&this.modalKeyWindow&&this.modalKeyWindow.removeEventListener("keydown",this.modalKeyListener,!0),this.modalKeyListener=void 0,this.modalKeyWindow=void 0)}interceptModalKeys(e){var u;if(!e[this.settings.modifierKey]||!S(e.key))return;e.preventDefault(),e.stopImmediatePropagation();let t=Number(e.key)-1,i=(u=this.activeModal)==null?void 0:u.querySelector(".suggestion, .prompt-results");if(!i)return;let l=Array.from(i.querySelectorAll(".suggestion-item:not(.mod-group)")).slice(0,9)[t];l&&l.click()}checkForActiveModal(){let e=document.querySelector(".modal-container, .suggestion-container");e instanceof HTMLElement&&this.handleModalOpen(e)}onunload(){this.modalObserver.disconnect(),f(document,this.settings.transitionStyle),document.removeEventListener("keydown",this.modifierKeyListener),document.removeEventListener("keyup",this.modifierKeyListener),this.popoutWindows.forEach(e=>{e.removeEventListener("keydown",this.modifierKeyListener),e.removeEventListener("keyup",this.modifierKeyListener)}),this.modalKeyListener&&this.modalKeyWindow&&this.modalKeyWindow.removeEventListener("keydown",this.modalKeyListener,!0)}};

/* nosourcemap */