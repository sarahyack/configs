/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var S=Object.defineProperty;var L=Object.getOwnPropertyDescriptor;var E=Object.getOwnPropertyNames;var P=Object.prototype.hasOwnProperty;var C=(n,i)=>{for(var e in i)S(n,e,{get:i[e],enumerable:!0})},Q=(n,i,e,o)=>{if(i&&typeof i=="object"||typeof i=="function")for(let t of E(i))!P.call(n,t)&&t!==e&&S(n,t,{get:()=>i[t],enumerable:!(o=L(i,t))||o.enumerable});return n};var x=n=>Q(S({},"__esModule",{value:!0}),n);var b={};C(b,{default:()=>y});module.exports=x(b);var p=require("obsidian");var u=require("obsidian"),v={modifierKey:"metaKey",transitionStyle:"slide"},h=class extends u.PluginSettingTab{constructor(i,e){super(i,e),this.plugin=e}display(){let{containerEl:i}=this;i.empty(),i.createEl("h1",{text:"Quick Select Settings"});let e=i.createSpan();e.setText(" (press key)"),document.addEventListener("keydown",o=>{(o.metaKey||o.ctrlKey||o.altKey)&&e.setText(o.key)}),new u.Setting(i).setName("Modifier key").setDesc(createFragment(o=>{o.appendText("Choose the key that activates Quick Select: "),o.append(e)})).addDropdown(o=>o.addOptions({metaKey:"Meta",ctrlKey:"Control",altKey:"Alt"}).setValue(this.plugin.settings.modifierKey).onChange(async t=>{this.plugin.settings.modifierKey=t,await this.plugin.saveSettings()})),new u.Setting(i).setName("Counter transition style").setDesc("Set transition style of Quick Select counters").addDropdown(o=>o.addOptions({none:"None",fade:"Fade",slide:"Slide",permanent:"Permanent"}).setValue(this.plugin.settings.transitionStyle).onChange(async t=>{document.body.classList.forEach(s=>{/^quick-select-transition-/.test(s)&&document.body.classList.remove(s)}),document.body.classList.add(`quick-select-transition-${t}`),this.plugin.settings.transitionStyle=t,await this.plugin.saveSettings()}))}};var w=n=>{n.body.classList.add("quick-select-mod-key-active")},M=(n,i)=>{n.body.classList.add(`quick-select-transition-${i}`)},g=n=>{n.body.classList.remove("quick-select-mod-key-active")},O=(n,i)=>{n.body.classList.remove(`quick-select-transition-${i}`)},K=n=>"app"in n&&"workspace"in n.app;var y=class extends p.Plugin{constructor(){super(...arguments);this.activeModal=null;this.isModifierKeyPressed=!1;this.modifierKeyListener=e=>this.handleModifierKeyChange(e);this.modalScopeStack=new Map;this.popoverScopeStack=new Map;this.popoutWindows=new Set;this.origSuggestOpen=p.SuggestModal.prototype.open;this.origSuggestClose=p.SuggestModal.prototype.close;this.origPopoverOpen=p.PopoverSuggest.prototype.open;this.origPopoverClose=p.PopoverSuggest.prototype.close}async onload(){window.quickOpenPlugin=this,await this.loadSettings(),this.addSettingTab(new h(this.app,this)),this.registerEvent(this.app.workspace.on("layout-change",this.handleLayoutChange.bind(this))),M(document,this.settings.transitionStyle),document.addEventListener("keydown",this.modifierKeyListener),document.addEventListener("keyup",this.modifierKeyListener),this.patchSuggestModal(),this.patchPopoverSuggest()}patchSuggestModal(){let e=this;p.SuggestModal.prototype.open=function(...o){try{e.origSuggestOpen.apply(this,o);let t=window.quickOpenPlugin;if(t&&(t.activeModal=this.modalEl,t.updateModalModifierClass()),e.modalScopeStack.has(this)){let r=e.modalScopeStack.get(this);r&&this.app.keymap.popScope(r)}let s=new p.Scope(this.scope);e.modalScopeStack.set(this,s);for(let r=1;r<=9;r++)s.register([e.getKeymapModifier()],r.toString(),a=>{var d,l,m,f,k;a.preventDefault();let c=r-1;!((d=this.chooser)!=null&&d.values)||c>=this.chooser.values.length||(this.chooser.setSelectedItem(c,a),(k=(m=(l=this.chooser).useSelectedItem)==null?void 0:m.call(l,a))!=null||(f=this.onChooseItem)==null||f.call(this,this.chooser.values[c],a))});this.app.keymap.pushScope(s)}catch(t){console.error("QuickOpen: Error in SuggestModal.open:",t)}},p.SuggestModal.prototype.close=function(...o){try{let t=e.modalScopeStack.get(this);t&&(this.app.keymap.popScope(t),e.modalScopeStack.delete(this)),e.origSuggestClose.apply(this,o);let s=window.quickOpenPlugin;s&&(s.activeModal=null,g(document))}catch(t){console.error("QuickOpen: Error in SuggestModal.close:",t);let s=e.modalScopeStack.get(this);if(s){try{this.app.keymap.popScope(s)}catch(r){console.error("QuickOpen: Failed to pop scope:",r)}e.modalScopeStack.delete(this)}}}}patchPopoverSuggest(){let e=this;p.PopoverSuggest.prototype.open=function(...o){try{e.origPopoverOpen.apply(this,o);let t=window.quickOpenPlugin;if(t&&(t.activeModal=this.suggestEl,t.updateModalModifierClass()),this.suggestions.values.length<1)return;if(e.popoverScopeStack.has(this)){let a=e.popoverScopeStack.get(this);a&&this.app.keymap.popScope(a)}let s=new p.Scope(this.scope);e.popoverScopeStack.set(this,s);let r=this.suggestions.values.map((a,c)=>({i:c,v:a})).filter(({v:a})=>a.type!=="group").map(({i:a})=>a);for(let a=1;a<=9;a++)s.register([e.getKeymapModifier()],a.toString(),c=>{c.preventDefault();let d=a-1,l=r[d];l!=null&&(!this.suggestions||d>=this.suggestions.length||(this.suggestions.setSelectedItem(l),this.suggestions.useSelectedItem?this.suggestions.useSelectedItem(c):this.suggestions.chooser.selectSuggestion&&this.suggestions.chooser.selectSuggestion(this.suggestions[d])))});this.app.keymap.pushScope(s)}catch(t){console.error("QuickOpen: Error in PopoverSuggest.open:",t)}},p.PopoverSuggest.prototype.close=function(...o){try{let t=e.popoverScopeStack.get(this);t&&(this.app.keymap.popScope(t),e.popoverScopeStack.delete(this)),e.origPopoverClose.apply(this,o);let s=window.quickOpenPlugin;s&&(s.activeModal=null,g(document))}catch(t){console.error("QuickOpen: Error in PopoverSuggest.close:",t);let s=e.popoverScopeStack.get(this);if(s){try{this.app.keymap.popScope(s)}catch(r){console.error("QuickOpen: Failed to pop scope:",r)}e.popoverScopeStack.delete(this)}}}}onunload(){for(let[e,o]of this.modalScopeStack)try{this.app.keymap.popScope(o)}catch(t){console.warn("QuickOpen: Failed to pop modal scope during unload:",t)}this.modalScopeStack.clear();for(let[e,o]of this.popoverScopeStack)try{this.app.keymap.popScope(o)}catch(t){console.warn("QuickOpen: Failed to pop popover scope during unload:",t)}this.popoverScopeStack.clear(),O(document,this.settings.transitionStyle),this.modifierKeyListener&&(document.removeEventListener("keydown",this.modifierKeyListener),document.removeEventListener("keyup",this.modifierKeyListener)),p.SuggestModal.prototype.open=this.origSuggestOpen,p.SuggestModal.prototype.close=this.origSuggestClose,p.PopoverSuggest.prototype.open=this.origPopoverOpen,p.PopoverSuggest.prototype.close=this.origPopoverClose,delete window.quickOpenPlugin}async loadSettings(){this.settings=Object.assign({},v,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}handleModifierKeyChange(e){let o=e[this.settings.modifierKey];this.isModifierKeyPressed!==o&&(this.isModifierKeyPressed=o,this.activeModal&&this.updateModalModifierClass())}updateModalModifierClass(){this.activeModal&&(this.isModifierKeyPressed?setTimeout(()=>{this.activeModal&&this.isModifierKeyPressed&&w(this.activeModal.ownerDocument)},150):g(this.activeModal.ownerDocument))}handleLayoutChange(){this.app.workspace.iterateAllLeaves(e=>{let o=e.view.containerEl.closest("body");if(o&&o.classList.contains("is-popout-window")){let t=o.ownerDocument.defaultView;t&&K(t)&&!this.popoutWindows.has(t)&&this.initializePopoutWindow(t)}})}initializePopoutWindow(e){this.popoutWindows.add(e),e.addEventListener("keydown",this.modifierKeyListener),e.addEventListener("keyup",this.modifierKeyListener),this.register(()=>{e.removeEventListener("keydown",this.modifierKeyListener),e.removeEventListener("keyup",this.modifierKeyListener),this.popoutWindows.delete(e)})}getKeymapModifier(){switch(this.settings.modifierKey){case"metaKey":return"Mod";case"ctrlKey":return"Ctrl";case"altKey":return"Alt";default:return"Mod"}}};

/* nosourcemap */